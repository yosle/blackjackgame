var bar=new ProgressBar.SemiCircle(dealHand,{strokeWidth:6,color:"#FFEA82",trailColor:"#eee",trailWidth:.5,easing:"easeInOut",duration:100,svgStyle:null,text:{value:"Cargando...",alignToBottom:!0},from:{color:"#ED6A5A"},to:{color:"#7FFF00"},step:(e,l)=>{l.path.setAttribute("stroke",e.color);var t=Math.round(100*l.value());0===t?l.setText("Cargando..."):t<=90?l.setText(`Cargando ${t}%`):90<t&&t<100?l.setText(`Ya casi... ${t}%`):100===t&&(document.querySelector("#dealHand").style="display : none;"),l.text.style.color=e.color}}),queue=(bar.text.style.fontFamily='"Raleway", Helvetica, sans-serif',bar.text.style.fontSize="3em",bar.text.style.textAlign="center",bar.text.style.bottom="50%",new createjs.LoadQueue(!1)),preloadedCards=new Array,dealerPreloaderCards=new Array;async function PreloaderAll(){queue.loadFile("cards/2C.png"),queue.loadFile("cards/2D.png"),queue.loadFile("cards/2H.png"),queue.loadFile("cards/2S.png"),queue.loadFile("cards/3C.png"),queue.loadFile("cards/3D.png"),queue.loadFile("cards/3H.png"),queue.loadFile("cards/3S.png"),queue.loadFile("cards/4C.png"),queue.loadFile("cards/4D.png"),queue.loadFile("cards/4H.png"),queue.loadFile("cards/4S.png"),queue.loadFile("cards/5C.png"),queue.loadFile("cards/5D.png"),queue.loadFile("cards/5H.png"),queue.loadFile("cards/5S.png"),queue.loadFile("cards/6C.png"),queue.loadFile("cards/6D.png"),queue.loadFile("cards/6H.png"),queue.loadFile("cards/6S.png"),queue.loadFile("cards/7C.png"),queue.loadFile("cards/7D.png"),queue.loadFile("cards/7H.png"),queue.loadFile("cards/7S.png"),queue.loadFile("cards/8C.png"),queue.loadFile("cards/8D.png"),queue.loadFile("cards/8H.png"),queue.loadFile("cards/8S.png"),queue.loadFile("cards/9C.png"),queue.loadFile("cards/9D.png"),queue.loadFile("cards/9H.png"),queue.loadFile("cards/9S.png"),queue.loadFile("cards/AC.png"),queue.loadFile("cards/AD.png"),queue.loadFile("cards/AH.png"),queue.loadFile("cards/AS.png"),queue.loadFile("cards/JC.png"),queue.loadFile("cards/JD.png"),queue.loadFile("cards/JH.png"),queue.loadFile("cards/JS.png"),queue.loadFile("cards/KC.png"),queue.loadFile("cards/KD.png"),queue.loadFile("cards/KH.png"),queue.loadFile("cards/KS.png"),queue.loadFile("cards/QC.png"),queue.loadFile("cards/QD.png"),queue.loadFile("cards/QH.png"),queue.loadFile("cards/QS.png"),queue.loadFile("cards/TC.png"),queue.loadFile("cards/TD.png"),queue.loadFile("cards/TH.png"),queue.loadFile("cards/TS.png"),queue.on("fileload",e=>{e.item.id;preloadedCards.push({cardName:e.item.id,image:e.result}),dealerPreloaderCards.push({cardName:e.item.id,image:e.result})}),queue.on("progress",function(e){bar.animate(queue.progress)}),queue.on("complete",e=>{bar.destroy()})}PreloaderAll();var winsound=new Audio("sound/victory.ogg");const valuesBJ={suits:["H","D","C","S"],ranks:["2","3","4","5","6","7","8","9","T","J","Q","K","A"],values:{2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,T:10,J:10,Q:10,K:10,A:[1,11]}};var x,doubleChips,debitChips,otracarta,plySum=0,dealSum=0,bet=0;async function init(){debitChips=await async function(){try{const t=await fetch("api.php?t=123");var e;if(!t.ok)throw e="Error with Status Code: "+t.status,new Error(e);var l=await t.json();return parseInt(l.chips)}catch(e){console.log("Error: "+e)}}(),console.log(debitChips),document.querySelector("#chipCountResult").innerHTML=debitChips,document.querySelector("#hitbutton").disabled=!0,document.querySelector("#standbutton").disabled=!0,document.querySelector("#hitBtn button").addEventListener("click",hit)}function hit(){x=ranCardGen();let e=document.querySelector("#plyCards");document.createElement("img");if(preloadedCurrentCard=preloadedCards.find(e=>e.cardName==="cards/"+x+".png"),console.log("Generated card by player is"+x),e.appendChild(preloadedCurrentCard.image),"A"===x[0]?plySum+=plySum+11<=21?11:1:plySum+=valuesBJ.values[x[0]],document.querySelector("#plyHandResult").innerHTML=plySum,console.log(plySum),21<plySum){let e=document.createElement("h1");e.innerHTML="HAS PERDIDO LA RONDA",e.id="plybust",document.querySelector("#bust").appendChild(e),document.querySelector("#hitbutton").disabled=!0,document.querySelector("#standbutton").disabled=!0,document.querySelector("#dealbutton").disabled=!0,setTimeout(refresh,5e3)}21===plySum&&(console.log("Has sacado blackjack"),console.log("El jugador se ha plantado"),setTimeout(stand,1e3))}function deal(e){bet=e,x=ranCardGen();let l=document.querySelector("#plyCards");document.createElement("img");console.log("Generated card by player is "+x),preloadedCurrentCard=preloadedCards.find(e=>e.cardName==="cards/"+x+".png"&&e.image),l.appendChild(preloadedCurrentCard.image),"A"===x[0]?plySum+=plySum+11<=21?11:1:plySum+=valuesBJ.values[x[0]],document.querySelector("#plyHandResult").innerHTML=plySum,document.querySelector("#dealbutton").disabled=!0,document.querySelector("#hitbutton").disabled=!1,document.querySelector("#standbutton").disabled=!1}async function stand(){if(document.querySelector("#dealbutton").disabled=!0,document.querySelector("#hitbutton").disabled=!0,document.querySelector("#standbutton").disabled=!0,plySum<=21){for(otracarta=!0;!0===await new Promise(e=>setTimeout(()=>{console.log("Pensando..."),dealSum<17&&dealSum<=plySum&&e(!0),(21<dealSum||plySum<dealSum)&&e(!1),e(!1)},1e3));)console.log("Crupier saca carta"),standMove();if(21<dealSum){otracarta=!1;let e=document.createElement("h1");e.innerHTML="WOW, HAS GANADO!!",e.id="dealbust",winsound.play(),document.querySelector("#bust").appendChild(e),setTimeout(refresh,2e3)}else if(plySum<dealSum){otracarta=!1;let e=document.createElement("h1");e.innerHTML="LO SIENTO, HAS PERDIDO",e.id="dealwin",document.querySelector("#bust").appendChild(e),setTimeout(refresh,2e3)}else if(dealSum<plySum){otracarta=!1;let e=document.createElement("h1");e.innerHTML="HAS GANADO EN EL TOTAL!!",winsound.play(),e.id="plywin",document.querySelector("#bust").appendChild(e),setTimeout(refresh,2e3)}else if(dealSum===plySum){let e=document.createElement("h1");e.innerHTML="ASOMBROSO, ES UN EMPATE",e.id="drawID",document.querySelector("#bust").appendChild(e),setTimeout(refresh,2e3)}console.log("dealSum is after"+dealSum)}}function standMove(){x=ranCardGen(),console.log("Generated card by dealer is "+x);let e=document.querySelector("#dealerCards");dealCurrentCard=dealerPreloaderCards.find(e=>e.cardName==="cards/"+x+".png"),e.appendChild(dealCurrentCard.image),"A"===x[0]?dealSum+=dealSum+11<=21?11:1:dealSum+=valuesBJ.values[x[0]],document.querySelector("#dealHandResult").innerHTML=dealSum,console.log("dealer sum is "+dealSum),console.log("Player sum is "+plySum)}function refresh(){21<dealSum?(document.querySelector("#dealbust").remove(),removeImg(),doubleChips=2*bet+debitChips,console.log("deal busted ",dealSum," saldo :",debitChips),document.querySelector("#chipCountResult").innerHTML="$"+doubleChips,debitChips=doubleChips,document.querySelector("#dealbutton").disabled=!1):plySum<dealSum?(document.querySelector("#dealwin").remove(),removeImg(),document.querySelector("#dealbutton").disabled=!1):21<plySum?(document.querySelector("#plybust").remove(),removeImg(),document.querySelector("#dealbutton").disabled=!1):dealSum<plySum?(document.querySelector("#plywin").remove(),removeImg(),doubleChips=2*bet+debitChips,console.log(`bet es ${bet} doubleChip es ${doubleChips} y debitchip es `+debitChips),document.querySelector("#chipCountResult").innerHTML="$"+doubleChips,debitChips=doubleChips,document.querySelector("#dealbutton").disabled=!1):dealSum===plySum&&(document.querySelector("#drawID").remove(),removeImg(),debitChips=parseInt(bet)+parseInt(debitChips),console.log(`debit chips ${debitChips} , bet ${bet} `),document.querySelector("#chipCountResult").innerHTML="$"+debitChips,debitChips=doubleChips,document.querySelector("#dealbutton").disabled=!1),0===debitChips&&(document.querySelector("#noChipMsg").innerHTML='<button class="btn btn-primary">RECARGAR</button>',document.querySelector("#dealbutton").disabled=!0),dealSum=plySum=bet=0,document.querySelector("#plyHandResult").innerHTML=plySum,document.querySelector("#dealHandResult").innerHTML=dealSum,console.log("saldo es "+debitChips)}function removeImg(){let l=document.querySelectorAll(".Cards img");for(let e=0;e<l.length;e++)l[e].remove()}function chips(){for(;bet<=0||debitChips+1<=bet;)bet=10;debitChips-=bet,document.querySelector("#chipCountResult").innerHTML="$"+debitChips}function ranCardGen(){let t=[];for(let l=0;l<valuesBJ.suits.length;l++)for(let e=0;e<valuesBJ.ranks.length;e++)t.push(valuesBJ.ranks[e]+valuesBJ.suits[l]);return t[Math.floor(52*Math.random())]}function validateDeal(){var l=document.querySelector("#montoInput");if((bet=l.value)<=0||debitChips+1<=bet){var l=document.getElementById("toast-body"),t=document.getElementById("myToastEl");bet<1&&(l.innerText="El monto no puede ser menor que 1"),debitChips<bet&&(l.innerText="No puedes jugar mas que el saldo que tienes");let e=new bootstrap.Toast(t);e.show(),console.log("Moto ivalido")}else debitChips-=bet,document.querySelector("#chipCountResult").innerHTML="$"+debitChips,deal(bet)}init(),document.querySelector("#standBtn button").addEventListener("click",stand);
